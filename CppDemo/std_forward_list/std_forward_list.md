# std::forward_list è¯¦ç»†è§£æ

## ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
3. [æˆå‘˜å‡½æ•°è¯¦è§£](#æˆå‘˜å‡½æ•°è¯¦è§£)
4. [æ—¶é—´å¤æ‚åº¦](#æ—¶é—´å¤æ‚åº¦)
5. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
6. [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¦‚è¿°

`std::forward_list`æ˜¯C++11å¼•å…¥çš„**å•å‘é“¾è¡¨å®¹å™¨**ï¼Œçœå»äº†åå‘æŒ‡é’ˆï¼Œå†…å­˜å¼€é”€æ¯”`std::list`æ›´å°ã€‚

### å®šä¹‰ä½ç½®

```cpp
#include <forward_list>
```

### æ¨¡æ¿å£°æ˜

```cpp
template<class T, class Allocator = std::allocator<T>>
class forward_list;
```

- **T**: å…ƒç´ ç±»å‹
- **Allocator**: å†…å­˜åˆ†é…å™¨

### ä¸ºä»€ä¹ˆé€‰æ‹© std::forward_listï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ğŸ“¦ std::forward_list çš„ä¼˜åŠ¿              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… å†…å­˜é«˜æ•ˆï¼šæ¯èŠ‚ç‚¹ä»…1ä¸ªæŒ‡é’ˆï¼ˆvs listçš„2ä¸ªï¼‰ â”‚
â”‚ âœ… å•å‘éå†ï¼šé€‚åˆåªéœ€å‰å‘éå†çš„åœºæ™¯         â”‚
â”‚ âœ… O(1)æ“ä½œï¼šå¤´éƒ¨æ’å…¥/åˆ é™¤éå¸¸å¿«             â”‚
â”‚ âœ… ç¼“å­˜å‹å¥½ï¼šè¿ç»­å†…å­˜è®¿é—®æ¨¡å¼                 â”‚
â”‚ âœ… è½»é‡çº§ï¼šæœ€å°åŒ–å†…å­˜å¼€é”€                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | std::list | std::forward_list |
|------|-----------|-------------------|
| é“¾è¡¨ç±»å‹ | åŒå‘ | å•å‘ |
| æ¯èŠ‚ç‚¹æŒ‡é’ˆ | 2ä¸ªï¼ˆprev+nextï¼‰ | 1ä¸ªï¼ˆnextï¼‰ |
| å†…å­˜å¼€é”€ | è¾ƒå¤§ | **å°50%** |
| æ”¯æŒæ“ä½œ | å®Œæ•´ | å—é™ï¼ˆæ— size()ç­‰ï¼‰ |
| åå‘éå† | âœ… | âŒ |

---

## æˆå‘˜å‡½æ•°è¯¦è§£

### æ„é€ å‡½æ•°

```cpp
// 1. é»˜è®¤æ„é€ 
std::forward_list<int> fl1;

// 2. æŒ‡å®šå¤§å°æ„é€ 
std::forward_list<int> fl2(5);        // 5ä¸ªé»˜è®¤å€¼

// 3. æŒ‡å®šå¤§å°å’Œå€¼æ„é€ 
std::forward_list<int> fl3(5, 10);    // 5ä¸ª10

// 4. èŒƒå›´æ„é€ 
std::vector<int> v = {1, 2, 3};
std::forward_list<int> fl4(v.begin(), v.end());

// 5. åˆå§‹åŒ–åˆ—è¡¨æ„é€ 
std::forward_list<int> fl5 = {1, 2, 3, 4, 5};

// 6. æ‹·è´æ„é€ 
std::forward_list<int> fl6(fl5);
```

### å…ƒç´ è®¿é—®

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `front()` | è®¿é—®é¦–å…ƒç´  |
| `before_begin()` | è¿”å›é¦–å‰è¿­ä»£å™¨ |
| `begin()` / `end()` | å‰å‘è¿­ä»£å™¨ |

```cpp
std::forward_list<int> fl = {10, 20, 30};

// è®¿é—®é¦–å…ƒç´ 
int first = fl.front();  // 10

// âŒ ä¸æ”¯æŒ
// int last = fl.back();     // ç¼–è¯‘é”™è¯¯
// int mid = fl[1];          // ç¼–è¯‘é”™è¯¯
```

### ä¿®æ”¹æ“ä½œ

| å‡½æ•° | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| `push_front(val)` | O(1) | å¤´éƒ¨æ’å…¥ |
| `pop_front()` | O(1) | å¤´éƒ¨åˆ é™¤ |
| `insert_after(it, val)` | O(1) | åœ¨itåæ’å…¥ |
| `emplace_after(it, args)` | O(1) | åœ¨itååŸä½æ„é€  |
| `erase_after(it)` | O(1) | åˆ é™¤itåçš„å…ƒç´  |

```cpp
std::forward_list<int> fl = {1, 2, 3};

// å¤´éƒ¨æ“ä½œ
fl.push_front(0);        // {0, 1, 2, 3}
fl.pop_front();          // {1, 2, 3}

// ä½ç½®æ“ä½œï¼ˆåœ¨æŒ‡å®šä½ç½®ä¹‹åï¼‰
auto it = fl.begin();
fl.insert_after(it, 99);     // {1, 99, 2, 3}
fl.emplace_after(it, 100);   // {1, 100, 99, 2, 3}
fl.erase_after(it);          // {1, 99, 2, 3}
```

### ç‰¹æ®Šæ“ä½œ

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `remove(val)` | åˆ é™¤æ‰€æœ‰ç­‰äºvalçš„å…ƒç´  |
| `remove_if(pred)` | åˆ é™¤æ»¡è¶³æ¡ä»¶çš„å…ƒç´  |
| `unique()` | åˆ é™¤è¿ç»­é‡å¤å…ƒç´  |
| `reverse()` | åè½¬é“¾è¡¨ |
| `sort()` | æ’åº |
| `splice_after()` | æ‹¼æ¥é“¾è¡¨ |

```cpp
std::forward_list<int> fl = {1, 2, 2, 3, 3, 3, 4};

fl.remove(2);                // {1, 3, 3, 3, 4}
fl.remove_if([](int n) { return n % 2 == 0; });  // åˆ é™¤å¶æ•°
fl.unique();                 // {1, 3, 4}
fl.reverse();                // {4, 3, 1}
fl.sort();                   // {1, 3, 4}
```

### è¿­ä»£å™¨æ“ä½œ

```cpp
std::forward_list<int> fl = {1, 2, 3};

// before_begin() - è¿”å›é¦–å‰è¿­ä»£å™¨ï¼ˆç‰¹æ®Šï¼‰
auto it = fl.before_begin();  // æŒ‡å‘é¦–å…ƒç´ ä¹‹å‰
fl.insert_after(it, 0);       // å¯åœ¨é¦–å…ƒç´ å‰æ’å…¥ {0, 1, 2, 3}

// éå†
for (auto it = fl.begin(); it != fl.end(); ++it) {
    std::cout << *it << " ";
}
```

---

## æ—¶é—´å¤æ‚åº¦

| æ“ä½œ | å¤æ‚åº¦ |
|------|--------|
| è®¿é—®é¦–å…ƒç´  | **O(1)** |
| å¤´éƒ¨æ’å…¥/åˆ é™¤ | **O(1)** |
| ä»»æ„ä½ç½®æ’å…¥/åˆ é™¤ | **O(1)** |
| è®¿é—®ä¸­é—´å…ƒç´  | **O(n)** |
| size() | âŒ æ— æ­¤å‡½æ•° |
| æ’åº | **O(n log n)** |

---

## ä½¿ç”¨åœºæ™¯

### 1. å“ˆå¸Œè¡¨æ¡¶å®ç°

```cpp
// å“ˆå¸Œè¡¨ä½¿ç”¨forward_listä½œä¸ºæ¡¶
std::forward_list<std::pair<int, std::string>> buckets[10];

void insert(int key, const std::string& value) {
    size_t index = std::hash<int>{}(key) % 10;
    buckets[index].push_front({key, value});  // O(1)
}

std::string* find(int key) {
    size_t index = std::hash<int>{}(key) % 10;
    for (auto& [k, v] : buckets[index]) {
        if (k == key) return &v;
    }
    return nullptr;
}
```

### 2. å‰ç«¯æ’å…¥é¢‘ç¹çš„åœºæ™¯

```cpp
std::forward_list<int> fl;

// å¿«é€Ÿå‰ç«¯æ’å…¥
for (int i = 0; i < 1000; ++i) {
    fl.push_front(i);  // O(1)ï¼Œæ¯”listæ›´å¿«
}

// ç»“æœï¼š{999, 998, ..., 1, 0}
```

### 3. å†…å­˜å—é™ç¯å¢ƒ

```cpp
// åœ¨å†…å­˜å—é™çš„åµŒå…¥å¼ç³»ç»Ÿä¸­
// forward_listæ¯”listèŠ‚çœ50%çš„æŒ‡é’ˆå¼€é”€
std::forward_list<int> fl;

// æ¯ä¸ªèŠ‚ç‚¹ï¼šint + 1ä¸ªæŒ‡é’ˆï¼ˆ8å­—èŠ‚ï¼‰
// vs listï¼šint + 2ä¸ªæŒ‡é’ˆï¼ˆ16å­—èŠ‚ï¼‰
```

### 4. é“¾è¡¨æ“ä½œ

```cpp
std::forward_list<int> fl1 = {1, 2, 3};
std::forward_list<int> fl2 = {4, 5, 6};

// æ‹¼æ¥é“¾è¡¨
auto it = fl1.begin();
++it;
fl1.splice_after(it, fl2);  // fl1 = {1, 4, 5, 6, 2, 3}
```

---

## æ³¨æ„äº‹é¡¹

### 1. æ— size()å‡½æ•°

```cpp
std::forward_list<int> fl = {1, 2, 3};

// âŒ ç¼–è¯‘é”™è¯¯
// int n = fl.size();

// âœ… éœ€è¦æ‰‹åŠ¨è®¡ç®—
int count = 0;
for (auto it = fl.begin(); it != fl.end(); ++it) {
    count++;
}
```

### 2. æ— åå‘è¿­ä»£å™¨

```cpp
std::forward_list<int> fl = {1, 2, 3};

// âŒ ç¼–è¯‘é”™è¯¯
// for (auto it = fl.rbegin(); it != fl.rend(); ++it) { }

// âœ… åªèƒ½å‰å‘éå†
for (auto it = fl.begin(); it != fl.end(); ++it) {
    std::cout << *it << " ";
}
```

### 3. ä½ç½®æ“ä½œåœ¨"ä¹‹å"

```cpp
std::forward_list<int> fl = {1, 2, 3};

auto it = fl.begin();  // æŒ‡å‘1

// insert_afteråœ¨itä¹‹åæ’å…¥ï¼Œä¸æ˜¯ä¹‹å‰
fl.insert_after(it, 99);  // {1, 99, 2, 3}

// è¦åœ¨é¦–å…ƒç´ å‰æ’å…¥ï¼Œä½¿ç”¨before_begin()
fl.insert_after(fl.before_begin(), 0);  // {0, 1, 99, 2, 3}
```

### 4. æ€§èƒ½è€ƒè™‘

```cpp
std::forward_list<int> fl;

// âŒ ä½æ•ˆï¼šéœ€è¦éå†åˆ°æœ«å°¾
fl.push_front(1);
fl.push_front(2);
// å¦‚æœéœ€è¦åœ¨å°¾éƒ¨æ“ä½œï¼Œä½¿ç”¨list

// âœ… é«˜æ•ˆï¼šå¤´éƒ¨æ“ä½œ
fl.push_front(3);
fl.pop_front();
```

---

## å¸¸è§é—®é¢˜

### Q1: forward_list å’Œ list çš„åŒºåˆ«ï¼Ÿ

| ç‰¹æ€§ | std::list | std::forward_list |
|------|-----------|-------------------|
| é“¾è¡¨ç±»å‹ | åŒå‘ | å•å‘ |
| æŒ‡é’ˆæ•° | 2ä¸ª/èŠ‚ç‚¹ | 1ä¸ª/èŠ‚ç‚¹ |
| å†…å­˜å¼€é”€ | è¾ƒå¤§ | å°50% |
| åå‘éå† | âœ… | âŒ |
| size() | âœ… O(1) | âŒ |
| å°¾éƒ¨æ“ä½œ | âœ… | âŒ |

### Q2: ä½•æ—¶ä½¿ç”¨ forward_listï¼Ÿ

âœ… **é€‚åˆ**ï¼š
- å†…å­˜å—é™ç¯å¢ƒ
- åªéœ€å•å‘éå†
- ä¸»è¦åœ¨å¤´éƒ¨æ“ä½œ
- å®ç°å“ˆå¸Œè¡¨æ¡¶
- é¢‘ç¹å‰ç«¯æ’å…¥

âŒ **ä¸é€‚åˆ**ï¼š
- éœ€è¦åå‘éå† â†’ ä½¿ç”¨ list
- éœ€è¦size() â†’ ä½¿ç”¨ list
- éœ€è¦åœ¨å°¾éƒ¨æ“ä½œ â†’ ä½¿ç”¨ list
- éœ€è¦å¿«é€Ÿè·å–å¤§å° â†’ ä½¿ç”¨ list

### Q3: å¦‚ä½•è·å– forward_list çš„å¤§å°ï¼Ÿ

```cpp
std::forward_list<int> fl = {1, 2, 3, 4, 5};

// æ–¹æ³•1ï¼šæ‰‹åŠ¨è®¡ç®—
int size = 0;
for (auto it = fl.begin(); it != fl.end(); ++it) {
    size++;
}

// æ–¹æ³•2ï¼šä½¿ç”¨std::distance
int size2 = std::distance(fl.begin(), fl.end());

// æ–¹æ³•3ï¼šç»´æŠ¤å¤§å°å˜é‡
class MyForwardList {
    std::forward_list<int> data;
    int size_ = 0;
public:
    void push_front(int val) {
        data.push_front(val);
        size_++;
    }
    int size() const { return size_; }
};
```

### Q4: å¦‚ä½•åœ¨ forward_list ä¸­åˆ é™¤å…ƒç´ ï¼Ÿ

```cpp
std::forward_list<int> fl = {1, 2, 3, 4, 5};

// æ–¹æ³•1ï¼šåˆ é™¤é¦–å…ƒç´ 
fl.pop_front();  // {2, 3, 4, 5}

// æ–¹æ³•2ï¼šåˆ é™¤æŒ‡å®šä½ç½®ä¹‹åçš„å…ƒç´ 
auto it = fl.begin();
++it;  // æŒ‡å‘3
fl.erase_after(it);  // {2, 3, 5}

// æ–¹æ³•3ï¼šåˆ é™¤æ‰€æœ‰ç­‰äºæŸå€¼çš„å…ƒç´ 
fl.remove(3);  // {2, 5}

// æ–¹æ³•4ï¼šåˆ é™¤æ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
fl.remove_if([](int n) { return n > 3; });
```

---

## æ€»ç»“

### ä½•æ—¶ä½¿ç”¨ std::forward_list

âœ… **é€‚åˆ**ï¼š
- å†…å­˜å—é™ç¯å¢ƒ
- åªéœ€å•å‘éå†
- é¢‘ç¹å¤´éƒ¨æ“ä½œ
- å®ç°å“ˆå¸Œè¡¨
- é“¾è¡¨ç®—æ³•

âŒ **ä¸é€‚åˆ**ï¼š
- éœ€è¦åå‘éå† â†’ ä½¿ç”¨ list
- éœ€è¦size() â†’ ä½¿ç”¨ list
- éœ€è¦å°¾éƒ¨æ“ä½œ â†’ ä½¿ç”¨ list
- éœ€è¦éšæœºè®¿é—® â†’ ä½¿ç”¨ vector

### æœ€ä½³å®è·µ

1. **ä¼˜å…ˆä½¿ç”¨å¤´éƒ¨æ“ä½œ** push_front/pop_front
2. **ä½¿ç”¨before_begin()** åœ¨é¦–å…ƒç´ å‰æ’å…¥
3. **è®°ä½ä½ç½®æ“ä½œåœ¨"ä¹‹å"** insert_after/erase_after
4. **é¿å…é¢‘ç¹size()è°ƒç”¨** è‡ªå·±ç»´æŠ¤è®¡æ•°
5. **è€ƒè™‘å†…å­˜å¼€é”€** åœ¨å†…å­˜å—é™æ—¶ä½¿ç”¨

---

## å‚è€ƒæ–‡æ¡£
- [cppreference - std::forward_list](https://en.cppreference.com/w/cpp/container/forward_list)
