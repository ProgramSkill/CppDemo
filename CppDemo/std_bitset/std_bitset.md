# std::bitset è¯¦ç»†è§£æ

## ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
3. [æˆå‘˜å‡½æ•°è¯¦è§£](#æˆå‘˜å‡½æ•°è¯¦è§£)
4. [ä½æ“ä½œ](#ä½æ“ä½œ)
5. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
6. [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¦‚è¿°

`std::bitset`æ˜¯**å›ºå®šå¤§å°çš„ä½é›†åˆ**ï¼Œç”¨äºé«˜æ•ˆçš„ä½æ“ä½œï¼Œæ¯ä¸ªå…ƒç´ å ç”¨1æ¯”ç‰¹ã€‚

### å®šä¹‰ä½ç½®

```cpp
#include <bitset>
```

### æ¨¡æ¿å£°æ˜

```cpp
template<size_t N>
class bitset;
```

- **N**: ä½é›†åˆçš„å¤§å°ï¼ˆç¼–è¯‘æ—¶å¸¸é‡ï¼‰

### ä¸ºä»€ä¹ˆé€‰æ‹© std::bitsetï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ“¦ std::bitset çš„ä¼˜åŠ¿                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… å†…å­˜ç´§å‡‘ï¼šæ¯ä¸ªå…ƒç´ ä»…å 1æ¯”ç‰¹                â”‚
â”‚ âœ… é«˜æ•ˆæ“ä½œï¼šä½æ“ä½œéå¸¸å¿«é€Ÿ                   â”‚
â”‚ âœ… å›ºå®šå¤§å°ï¼šç¼–è¯‘æ—¶ç¡®å®šï¼Œæ— åŠ¨æ€åˆ†é…           â”‚
â”‚ âœ… ä¸°å¯Œæ¥å£ï¼šæä¾›å¤šç§ä½æ“ä½œæ–¹æ³•                â”‚
â”‚ âœ… ç±»å‹å®‰å…¨ï¼šç¼–è¯‘æ—¶æ£€æŸ¥å¤§å°                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| å›ºå®šå¤§å° | ç¼–è¯‘æ—¶ç¡®å®šï¼Œä¸å¯æ”¹å˜ |
| ä½æ“ä½œ | é«˜æ•ˆçš„ä½çº§æ“ä½œ |
| å†…å­˜ç´§å‡‘ | æ¯ä¸ªå…ƒç´ 1æ¯”ç‰¹ |
| æ— è¿­ä»£å™¨ | ä¸æ”¯æŒè¿­ä»£å™¨ |
| ç±»å‹å®‰å…¨ | ç¼–è¯‘æ—¶æ£€æŸ¥å¤§å° |

---

## æˆå‘˜å‡½æ•°è¯¦è§£

### æ„é€ å‡½æ•°

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `bitset()` | é»˜è®¤æ„é€ ï¼Œå…¨0 |
| `bitset(unsigned long long)` | ä»æ•´æ•°æ„é€  |
| `bitset(const string&)` | ä»äºŒè¿›åˆ¶å­—ç¬¦ä¸²æ„é€  |

```cpp
// 1. é»˜è®¤æ„é€ ï¼ˆå…¨0ï¼‰
std::bitset<8> b1;  // 00000000

// 2. ä»æ•´æ•°æ„é€ 
std::bitset<8> b2(0b10101010);  // 10101010
std::bitset<8> b3(170);          // 10101010

// 3. ä»å­—ç¬¦ä¸²æ„é€ 
std::bitset<8> b4("10101010");   // 10101010

// 4. æ‹·è´æ„é€ 
std::bitset<8> b5(b2);           // 10101010
```

### å…ƒç´ è®¿é—®

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `operator[]` | è®¿é—®æŒ‡å®šä½ |
| `test(pos)` | æµ‹è¯•æŒ‡å®šä½æ˜¯å¦ä¸º1 |
| `count()` | è¿”å›1çš„ä¸ªæ•° |
| `size()` | è¿”å›ä½é›†åˆå¤§å° |

```cpp
std::bitset<8> b("10101010");

// operator[] - è®¿é—®ä½
bool bit = b[2];      // è®¿é—®ç¬¬2ä½
b[2] = 1;             // è®¾ç½®ç¬¬2ä½ä¸º1

// test() - æµ‹è¯•ä½
bool is_set = b.test(3);  // æµ‹è¯•ç¬¬3ä½

// count() - è®¡æ•°1çš„ä¸ªæ•°
int ones = b.count();     // 4

// size() - è·å–å¤§å°
int size = b.size();      // 8
```

### ä½æ“ä½œ

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `set()` | å…¨éƒ¨è®¾ä¸º1 |
| `set(pos)` | è®¾ç½®æŒ‡å®šä½ä¸º1 |
| `reset()` | å…¨éƒ¨è®¾ä¸º0 |
| `reset(pos)` | è®¾ç½®æŒ‡å®šä½ä¸º0 |
| `flip()` | å…¨éƒ¨ç¿»è½¬ |
| `flip(pos)` | ç¿»è½¬æŒ‡å®šä½ |

```cpp
std::bitset<8> b;

// set - è®¾ç½®ä¸º1
b.set();        // 11111111
b.set(2);       // 11111111 (ç¬¬2ä½å·²æ˜¯1)
b.reset();      // 00000000

// reset - è®¾ç½®ä¸º0
b.set();        // 11111111
b.reset(2);     // 11111011

// flip - ç¿»è½¬
b.flip();       // 00000100
b.flip(3);      // 00001100
```

### æŸ¥è¯¢æ“ä½œ

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `all()` | æ£€æŸ¥æ˜¯å¦å…¨1 |
| `any()` | æ£€æŸ¥æ˜¯å¦æœ‰1 |
| `none()` | æ£€æŸ¥æ˜¯å¦å…¨0 |

```cpp
std::bitset<8> b1("11111111");
std::bitset<8> b2("10101010");
std::bitset<8> b3("00000000");

b1.all();   // true
b2.all();   // false

b1.any();   // true
b3.any();   // false

b1.none();  // false
b3.none();  // true
```

---

## ä½æ“ä½œ

### é€»è¾‘è¿ç®—

```cpp
std::bitset<8> b1("11001100");
std::bitset<8> b2("10101010");

// ä¸è¿ç®—
std::bitset<8> and_result = b1 & b2;  // 10001000

// æˆ–è¿ç®—
std::bitset<8> or_result = b1 | b2;   // 11101110

// å¼‚æˆ–è¿ç®—
std::bitset<8> xor_result = b1 ^ b2;  // 01100110

// éè¿ç®—
std::bitset<8> not_result = ~b1;      // 00110011
```

### ç§»ä½è¿ç®—

```cpp
std::bitset<8> b("11001100");

// å·¦ç§»
std::bitset<8> left = b << 2;   // 00110000

// å³ç§»
std::bitset<8> right = b >> 2;  // 00110011

// åŸä½ç§»ä½
b <<= 1;  // 10011000
b >>= 1;  // 01001100
```

### è½¬æ¢

```cpp
std::bitset<8> b("10101010");

// è½¬æ¢ä¸ºå­—ç¬¦ä¸²
std::string str = b.to_string();  // "10101010"

// è½¬æ¢ä¸ºæ•´æ•°
unsigned long val = b.to_ulong();      // 170
unsigned long long val2 = b.to_ullong(); // 170
```

---

## ä½¿ç”¨åœºæ™¯

### 1. æ ‡å¿—ä½ç®¡ç†

```cpp
enum Permission { READ = 0, WRITE = 1, EXECUTE = 2 };

std::bitset<3> permissions;
permissions[READ] = true;
permissions[WRITE] = true;

if (permissions[READ]) {
    std::cout << "Can read" << std::endl;
}
```

### 2. é›†åˆæ“ä½œ

```cpp
// è¡¨ç¤ºé›†åˆ {0, 2, 4}
std::bitset<5> set1("10101");

// è¡¨ç¤ºé›†åˆ {0, 2}
std::bitset<5> set2("00101");

// äº¤é›†
std::bitset<5> intersection = set1 & set2;  // 00101

// å¹¶é›†
std::bitset<5> union_set = set1 | set2;    // 10101

// å·®é›†
std::bitset<5> difference = set1 & ~set2;  // 10000
```

### 3. åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•ï¼ˆè´¨æ•°ç­›ï¼‰

```cpp
const int N = 100;
std::bitset<N+1> is_prime;
is_prime.set();  // åˆå§‹åŒ–å…¨ä¸º1
is_prime[0] = is_prime[1] = false;

for (int i = 2; i * i <= N; ++i) {
    if (is_prime[i]) {
        for (int j = i * i; j <= N; j += i) {
            is_prime[j] = false;
        }
    }
}

// ç°åœ¨ is_prime[i] è¡¨ç¤º i æ˜¯å¦ä¸ºè´¨æ•°
```

### 4. å­é›†æšä¸¾

```cpp
std::bitset<4> mask;
int n = 4;

// æšä¸¾æ‰€æœ‰å­é›†
for (int i = 0; i < (1 << n); ++i) {
    mask = std::bitset<4>(i);
    std::cout << mask << std::endl;
}
```

### 5. çŠ¶æ€å‹ç¼©

```cpp
// ç”¨ä¸€ä¸ª bitset è¡¨ç¤ºæ£‹ç›˜çŠ¶æ€
std::bitset<64> board;  // 8x8 æ£‹ç›˜

// è®¾ç½®ä½ç½® (3, 4) ä¸º1
int pos = 3 * 8 + 4;
board[pos] = 1;

// æ£€æŸ¥ä½ç½®æ˜¯å¦æœ‰æ£‹å­
if (board[pos]) {
    std::cout << "Piece at (3, 4)" << std::endl;
}
```

---

## æ³¨æ„äº‹é¡¹

### 1. å¤§å°å¿…é¡»æ˜¯ç¼–è¯‘æ—¶å¸¸é‡

```cpp
const int n = 8;
std::bitset<n> b1;  // âœ… æ­£ç¡®

int m = 8;
// std::bitset<m> b2;  // âŒ ç¼–è¯‘é”™è¯¯
```

### 2. ä¸åŒå¤§å°çš„ bitset ä¸å…¼å®¹

```cpp
std::bitset<8> b1;
std::bitset<16> b2;

// âŒ ç¼–è¯‘é”™è¯¯ï¼šå¤§å°ä¸åŒ
// b1 = b2;
```

### 3. è¶Šç•Œè®¿é—®

```cpp
std::bitset<8> b;

// âŒ æœªå®šä¹‰è¡Œä¸º
// b[10] = 1;

// âœ… ä½¿ç”¨ test() è¿›è¡Œå®‰å…¨æ£€æŸ¥
if (b.test(10)) {  // æŠ›å‡º out_of_range
    // ...
}
```

### 4. è½¬æ¢é™åˆ¶

```cpp
std::bitset<64> b;
b.set();

// âœ… æ­£ç¡®
unsigned long long val = b.to_ullong();

// âŒ å¯èƒ½æº¢å‡ºï¼ˆå¦‚æœå¤§å° > 64ï¼‰
// std::bitset<128> b2;
// unsigned long long val2 = b2.to_ullong();  // åªè¿”å›ä½64ä½
```

---

## å¸¸è§é—®é¢˜

### Q1: bitset å’Œ vector<bool> çš„åŒºåˆ«ï¼Ÿ

| ç‰¹æ€§ | std::bitset | std::vector<bool> |
|------|-----------|------------------|
| å¤§å° | å›ºå®šï¼ˆç¼–è¯‘æ—¶ï¼‰ | åŠ¨æ€ï¼ˆè¿è¡Œæ—¶ï¼‰ |
| å†…å­˜ | æ ˆä¸Š | å †ä¸Š |
| ä½æ“ä½œ | ä¸°å¯Œ | æœ‰é™ |
| è¿­ä»£å™¨ | æ—  | æœ‰ï¼ˆä»£ç†å¯¹è±¡ï¼‰ |
| ä½¿ç”¨åœºæ™¯ | å¤§å°å·²çŸ¥ | å¤§å°æœªçŸ¥ |

### Q2: å¦‚ä½•è®¡ç®— bitset ä¸­1çš„ä¸ªæ•°ï¼Ÿ

```cpp
std::bitset<8> b("10101010");

// æ–¹æ³•1ï¼šä½¿ç”¨ count()
int ones = b.count();  // 4

// æ–¹æ³•2ï¼šæ‰‹åŠ¨è®¡æ•°
int count = 0;
for (int i = 0; i < b.size(); ++i) {
    if (b[i]) count++;
}
```

### Q3: å¦‚ä½•æ‰¾åˆ°ç¬¬ä¸€ä¸ª1çš„ä½ç½®ï¼Ÿ

```cpp
std::bitset<8> b("00101000");

// æ–¹æ³•1ï¼šé€ä½æ£€æŸ¥
int first_one = -1;
for (int i = 0; i < b.size(); ++i) {
    if (b[i]) {
        first_one = i;
        break;
    }
}

// æ–¹æ³•2ï¼šä½¿ç”¨ find_first() (æŸäº›å®ç°)
// int first = b._Find_first();
```

### Q4: å¦‚ä½•å°† bitset è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Ÿ

```cpp
std::bitset<8> b("10101010");

// æ–¹æ³•1ï¼što_ulong()
unsigned long val = b.to_ulong();  // 170

// æ–¹æ³•2ï¼šæ‰‹åŠ¨è®¡ç®—
unsigned long result = 0;
for (int i = 0; i < b.size(); ++i) {
    if (b[i]) {
        result += (1UL << i);
    }
}
```

---

## æ€»ç»“

### ä½•æ—¶ä½¿ç”¨ std::bitset

âœ… **é€‚åˆ**ï¼š
- å¤§å°åœ¨ç¼–è¯‘æ—¶å·²çŸ¥
- éœ€è¦é«˜æ•ˆçš„ä½æ“ä½œ
- å†…å­˜ç´§å‡‘å¾ˆé‡è¦
- æ ‡å¿—ä½ç®¡ç†
- é›†åˆæ“ä½œ
- è´¨æ•°ç­›æ³•

âŒ **ä¸é€‚åˆ**ï¼š
- å¤§å°åœ¨è¿è¡Œæ—¶ç¡®å®š â†’ ä½¿ç”¨ vector<bool>
- éœ€è¦åŠ¨æ€è°ƒæ•´å¤§å° â†’ ä½¿ç”¨ vector<bool>
- éœ€è¦è¿­ä»£å™¨ â†’ ä½¿ç”¨ vector<bool>

### æœ€ä½³å®è·µ

1. **ä½¿ç”¨ set/reset/flip** è€Œéç›´æ¥èµ‹å€¼
2. **ä½¿ç”¨ count()** è®¡ç®—1çš„ä¸ªæ•°
3. **ä½¿ç”¨ test()** è¿›è¡Œå®‰å…¨çš„ä½æ£€æŸ¥
4. **åˆ©ç”¨ä½è¿ç®—** è¿›è¡Œé«˜æ•ˆçš„é›†åˆæ“ä½œ

---

## å‚è€ƒæ–‡æ¡£
- [cppreference - std::bitset](https://en.cppreference.com/w/cpp/utility/bitset)
- [cppreference - std::vector<bool>](https://en.cppreference.com/w/cpp/container/vector_bool)
