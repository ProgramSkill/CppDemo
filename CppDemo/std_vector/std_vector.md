# std::vector è¯¦ç»†è§£æ

## ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
3. [å†…å­˜ç»“æ„](#å†…å­˜ç»“æ„)
4. [æˆå‘˜å‡½æ•°è¯¦è§£](#æˆå‘˜å‡½æ•°è¯¦è§£)
5. [æ—¶é—´å¤æ‚åº¦](#æ—¶é—´å¤æ‚åº¦)
6. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
7. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
8. [æ³¨æ„äº‹é¡¹](#æ³¨æ„äº‹é¡¹)
9. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æ¦‚è¿°

`std::vector` æ˜¯ C++ æ ‡å‡†åº“æä¾›çš„**åºåˆ—å®¹å™¨**ï¼ˆSequence Containerï¼‰ï¼Œå®ƒå°è£…äº†åŠ¨æ€æ•°ç»„çš„å®ç°ï¼Œæä¾›äº†å¯å˜å¤§å°çš„æ•°ç»„åŠŸèƒ½ã€‚

### å®šä¹‰ä½ç½®

```cpp
#include <vector>
```

### æ¨¡æ¿å£°æ˜

```cpp
template <class T, class Allocator = std::allocator<T>>
class vector;
```

- **T**: å…ƒç´ ç±»å‹
- **Allocator**: åˆ†é…å™¨ç±»å‹ï¼Œé»˜è®¤ä¸º `std::allocator<T>`

### ä¸ºä»€ä¹ˆé€‰æ‹© vectorï¼Ÿ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ“¦ std::vector çš„ä¼˜åŠ¿                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… åŠ¨æ€å¤§å°ï¼šè‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œæ— éœ€æ‰‹åŠ¨ new/delete â”‚
â”‚ âœ… è¿ç»­å­˜å‚¨ï¼šä¸æ•°ç»„ä¸€æ ·ï¼Œå…ƒç´ è¿ç»­å­˜æ”¾          â”‚
â”‚ âœ… éšæœºè®¿é—®ï¼šO(1) æ—¶é—´è®¿é—®ä»»æ„å…ƒç´             â”‚
â”‚ âœ… ç¼“å­˜å‹å¥½ï¼šè¿ç»­å†…å­˜ï¼Œå……åˆ†åˆ©ç”¨ CPU ç¼“å­˜      â”‚
â”‚ âœ… æ ‡å‡†æ¥å£ï¼šæ”¯æŒ STL ç®—æ³•                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒç‰¹æ€§

### 1. åŠ¨æ€æ•°ç»„

`std::vector` æ˜¯ä¸€ä¸ªèƒ½å¤Ÿ**è‡ªåŠ¨å¢é•¿å’Œæ”¶ç¼©**çš„åŠ¨æ€æ•°ç»„ï¼š

```cpp
std::vector<int> v;  // ç©ºå‘é‡
v.push_back(1);      // è‡ªåŠ¨æ‰©å®¹
v.push_back(2);
v.push_back(3);
// v = {1, 2, 3}
```

### 2. è¿ç»­å­˜å‚¨

vector ä¸­çš„å…ƒç´ åœ¨**å†…å­˜ä¸­è¿ç»­å­˜å‚¨**ï¼Œä¸æ™®é€šæ•°ç»„ç›¸åŒï¼š

```
å†…å­˜å¸ƒå±€ï¼š
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ 10 â”‚ 20 â”‚ 30 â”‚ 40 â”‚ 50 â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
  [0]  [1]  [2]  [3]  [4]

ç‰¹ç‚¹ï¼š
- è¿ç»­å†…å­˜ â†’ ç¼“å­˜å‹å¥½
- æ”¯æŒæŒ‡é’ˆè¿ç®—
- å¯ä¸ C æ•°ç»„äº’æ“ä½œ
```

### 3. è‡ªåŠ¨ç®¡ç†

vector **è‡ªåŠ¨ç®¡ç†å†…å­˜**ï¼Œæ— éœ€æ‰‹åŠ¨åˆ†é…å’Œé‡Šæ”¾ï¼š

```cpp
{
    std::vector<int> v(1000);  // åˆ†é…å†…å­˜
    // ä½¿ç”¨ v...
}  // è‡ªåŠ¨é‡Šæ”¾å†…å­˜ï¼Œæ— éœ€ delete
```

### 4. éšæœºè®¿é—®

æ”¯æŒ **O(1) æ—¶é—´å¤æ‚åº¦**çš„éšæœºè®¿é—®ï¼š

```cpp
std::vector<int> v = {10, 20, 30, 40};
int x = v[2];    // O(1)ï¼Œè®¿é—®ç¬¬ 3 ä¸ªå…ƒç´ 
int y = v.at(2); // O(1)ï¼Œå¸¦è¾¹ç•Œæ£€æŸ¥
```

---

## å†…å­˜ç»“æ„

### size å’Œ capacity

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           vector çš„å†…å­˜æ¨¡å‹                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    capacity: 8           å®é™…åˆ†é…çš„å†…å­˜ç©ºé—´
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ [ ] [ ] [ ] [ ] [ ] [ ] [ ] [ ]     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
    size: 5         å½“å‰ä½¿ç”¨çš„å…ƒç´ æ•°é‡
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”
    â”‚ [10] [20] [30] [40] [50] [ ] [ ] [ ] â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     å…ƒç´ 1  å…ƒç´ 2  å…ƒç´ 3  å…ƒç´ 4  å…ƒç´ 5

é‡è¦æ¦‚å¿µï¼š
- size: å½“å‰å…ƒç´ æ•°é‡
- capacity: æ€»å®¹é‡ï¼Œæ— éœ€é‡æ–°åˆ†é…å¯å­˜å‚¨çš„å…ƒç´ æ€»æ•°
- size â‰¤ capacity
```

### æ‰©å®¹æœºåˆ¶

å½“ `size == capacity` æ—¶ï¼Œvector ä¼šè‡ªåŠ¨æ‰©å®¹ï¼š

```
æ‰©å®¹è¿‡ç¨‹ï¼š

1. ç”³è¯·æ–°å†…å­˜ï¼ˆé€šå¸¸æ˜¯ capacity çš„ 2 å€ï¼‰
2. å°†æ—§å…ƒç´ å¤åˆ¶åˆ°æ–°å†…å­˜
3. é‡Šæ”¾æ—§å†…å­˜

ç¤ºä¾‹ï¼š
åˆå§‹: capacity = 4, size = 4
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚  â†’ push_back(5) â†’ è§¦å‘æ‰©å®¹
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜

æ‰©å®¹å: capacity = 8, size = 5
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”
â”‚ 1 â”‚ 2 â”‚ 3 â”‚ 4 â”‚ 5 â”‚   â”‚   â”‚   â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜
```

---

## æˆå‘˜å‡½æ•°è¯¦è§£

### æ„é€ å‡½æ•°

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `vector()` | é»˜è®¤æ„é€ å‡½æ•°ï¼Œç©ºå®¹å™¨ |
| `vector(size_type n)` | æ„é€ å« n ä¸ªå€¼çš„å®¹å™¨ |
| `vector(size_type n, const T& value)` | æ„é€  n ä¸ªå€¼ä¸º value çš„å®¹å™¨ |
| `vector(const vector& other)` | æ‹·è´æ„é€ å‡½æ•° |
| `vector(vector&& other)` | ç§»åŠ¨æ„é€ å‡½æ•° (C++11) |
| `vector(std::initializer_list<T>)` | åˆå§‹åŒ–åˆ—è¡¨æ„é€  (C++11) |

```cpp
// 1. é»˜è®¤æ„é€ 
std::vector<int> v1;  // ç©º vector

// 2. æŒ‡å®šå¤§å°
std::vector<int> v2(5);  // {0, 0, 0, 0, 0}

// 3. æŒ‡å®šå¤§å°å’Œåˆå§‹å€¼
std::vector<int> v3(5, 10);  // {10, 10, 10, 10, 10}

// 4. æ‹·è´æ„é€ 
std::vector<int> v4(v3);  // {10, 10, 10, 10, 10}

// 5. ç§»åŠ¨æ„é€  (C++11)
std::vector<int> v5(std::move(v4));

// 6. åˆå§‹åŒ–åˆ—è¡¨ (C++11)
std::vector<int> v6 = {1, 2, 3, 4, 5};

// 7. ä»è¿­ä»£å™¨èŒƒå›´æ„é€ 
std::list<int> lst = {1, 2, 3};
std::vector<int> v7(lst.begin(), lst.end());
```

### å…ƒç´ è®¿é—®

| å‡½æ•° | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| `operator[]` | O(1) | ä¸å¸¦è¾¹ç•Œæ£€æŸ¥çš„è®¿é—® |
| `at()` | O(1) | å¸¦è¾¹ç•Œæ£€æŸ¥çš„è®¿é—® |
| `front()` | O(1) | è®¿é—®é¦–å…ƒç´  |
| `back()` | O(1) | è®¿é—®å°¾å…ƒç´  |
| `data()` | O(1) | è¿”å›æŒ‡å‘å†…å­˜æ•°ç»„çš„æŒ‡é’ˆ (C++11) |

```cpp
std::vector<int> v = {10, 20, 30, 40, 50};

// operator[] - ä¸æ£€æŸ¥è¾¹ç•Œ
int x = v[2];     // 30
int y = v[10];    // âŒ æœªå®šä¹‰è¡Œä¸º

// at() - æ£€æŸ¥è¾¹ç•Œï¼Œè¶Šç•ŒæŠ›å‡º std::out_of_range
int z = v.at(2);  // 30
// int w = v.at(10); // âŒ æŠ›å‡ºå¼‚å¸¸

// front() å’Œ back()
int first = v.front();  // 10
int last = v.back();    // 50

// data() - è¿”å›åº•å±‚æŒ‡é’ˆ
int* ptr = v.data();    // ç­‰ä»·äº &v[0]
```

### è¿­ä»£å™¨

| å‡½æ•° | è¯´æ˜ |
|------|------|
| `begin()` | è¿”å›æŒ‡å‘é¦–å…ƒç´ çš„è¿­ä»£å™¨ |
| `end()` | è¿”å›æŒ‡å‘æœ«å°¾çš„è¿­ä»£å™¨ |
| `cbegin()` | è¿”å› const è¿­ä»£å™¨ (C++11) |
| `cend()` | è¿”å› const æœ«å°¾è¿­ä»£å™¨ (C++11) |
| `rbegin()` | è¿”å›åå‘è¿­ä»£å™¨ |
| `rend()` | è¿”å›åå‘æœ«å°¾è¿­ä»£å™¨ |

```cpp
std::vector<int> v = {1, 2, 3, 4, 5};

// æ­£å‘éå†
for (auto it = v.begin(); it != v.end(); ++it) {
    std::cout << *it << " ";
}

// èŒƒå›´ for å¾ªç¯ (C++11)
for (const auto& elem : v) {
    std::cout << elem << " ";
}

// åå‘éå†
for (auto it = v.rbegin(); it != v.rend(); ++it) {
    std::cout << *it << " ";
}
```

### å®¹é‡æ“ä½œ

| å‡½æ•° | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| `size()` | O(1) | è¿”å›å…ƒç´ æ•°é‡ |
| `capacity()` | O(1) | è¿”å›å½“å‰å®¹é‡ |
| `empty()` | O(1) | æ£€æŸ¥æ˜¯å¦ä¸ºç©º |
| `max_size()` | O(1) | è¿”å›å¯å­˜å‚¨çš„æœ€å¤§å…ƒç´ æ•° |
| `reserve(size_t n)` | - | é¢„ç•™å®¹é‡ |
| `shrink_to_fit()` | - | è¯·æ±‚é‡Šæ”¾æœªä½¿ç”¨å®¹é‡ (C++11) |

```cpp
std::vector<int> v;

// æ£€æŸ¥æ˜¯å¦ä¸ºç©º
if (v.empty()) {
    std::cout << "Vector is empty" << std::endl;
}

// é¢„ç•™å®¹é‡
v.reserve(100);  // capacity >= 100
std::cout << "Capacity: " << v.capacity(); // 100

// è·å–å¤§å°
v.push_back(1);
std::cout << "Size: " << v.size();  // 1

// é‡Šæ”¾æœªä½¿ç”¨å®¹é‡
v.shrink_to_fit();  // capacity å¯èƒ½å‡å°‘
```

### ä¿®æ”¹æ“ä½œ

| å‡½æ•° | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| `assign()` | O(n) | èµ‹å€¼ |
| `push_back(const T&)` | O(1)* | åœ¨å°¾éƒ¨æ·»åŠ å…ƒç´  |
| `push_back(T&&)` | O(1)* | åœ¨å°¾éƒ¨ç§»åŠ¨å…ƒç´  (C++11) |
| `pop_back()` | O(1) | åˆ é™¤å°¾éƒ¨å…ƒç´  |
| `insert()` | O(n) | åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´  |
| `erase()` | O(n) | åˆ é™¤æŒ‡å®šä½ç½®å…ƒç´  |
| `clear()` | O(n) | æ¸…ç©ºæ‰€æœ‰å…ƒç´  |
| `resize()` | O(n) | æ”¹å˜å¤§å° |
| `swap()` | O(1) | äº¤æ¢å†…å®¹ |

```cpp
std::vector<int> v = {1, 2, 3};

// push_back - å°¾éƒ¨æ’å…¥
v.push_back(4);  // {1, 2, 3, 4}
v.push_back(5);  // {1, 2, 3, 4, 5}

// pop_back - å°¾éƒ¨åˆ é™¤
v.pop_back();    // {1, 2, 3, 4}

// insert - æŒ‡å®šä½ç½®æ’å…¥
auto it = v.begin() + 2;
v.insert(it, 99);  // {1, 2, 99, 3, 4}

// erase - åˆ é™¤æŒ‡å®šä½ç½®
it = v.begin() + 2;
v.erase(it);       // {1, 2, 3, 4}

// clear - æ¸…ç©º
v.clear();         // {}

// resize - æ”¹å˜å¤§å°
v.resize(5, 10);   // {10, 10, 10, 10, 10}
```

### emplace æ“ä½œ (C++11)

| å‡½æ•° | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| `emplace_back(Args&&...)` | O(1)* | åŸä½æ„é€ å…ƒç´  |
| `emplace(pos, Args&&...)` | O(n) | åŸä½æ’å…¥å…ƒç´  |

```cpp
struct Point {
    int x, y;
    Point(int a, int b) : x(a), y(b) {}
};

std::vector<Point> v;

// push_back - å…ˆæ„é€ ï¼Œå†ç§»åŠ¨/æ‹·è´
v.push_back(Point(1, 2));

// emplace_back - ç›´æ¥åœ¨ vector å†…å­˜ä¸­æ„é€ 
v.emplace_back(3, 4);  // æ›´é«˜æ•ˆ
```

---

## æ—¶é—´å¤æ‚åº¦

| æ“ä½œ | æ—¶é—´å¤æ‚åº¦ | è¯´æ˜ |
|------|-----------|------|
| éšæœºè®¿é—® `[]` | **O(1)** | å¸¸æ•°æ—¶é—´ |
| å°¾éƒ¨æ’å…¥/åˆ é™¤ `push_back/pop_back` | **O(1)** | æ‘Šé”€å¸¸æ•°æ—¶é—´ |
| å¤´éƒ¨/ä¸­é—´æ’å…¥ `insert` | O(n) | éœ€è¦ç§»åŠ¨å…ƒç´  |
| å¤´éƒ¨/ä¸­é—´åˆ é™¤ `erase` | O(n) | éœ€è¦ç§»åŠ¨å…ƒç´  |
| æŸ¥æ‰¾ | O(n) | éœ€è¦éå† |
| `size()` | **O(1)** | å¸¸æ•°æ—¶é—´ |
| `resize()` | O(n) | å¯èƒ½éœ€è¦æ„é€ /ææ„å…ƒç´  |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ğŸ“Š æ“ä½œå¤æ‚åº¦å¯¹æ¯”                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¿«é€Ÿæ“ä½œ O(1):                              â”‚
â”‚   - è®¿é—®å…ƒç´  v[i], v.at(i)                  â”‚
â”‚   - å°¾éƒ¨æ“ä½œ push_back, pop_back            â”‚
â”‚   - æŸ¥è¯¢å¤§å° size(), empty(), capacity()    â”‚
â”‚                                             â”‚
â”‚ è¾ƒæ…¢æ“ä½œ O(n):                              â”‚
â”‚   - æ’å…¥ insert (éå°¾éƒ¨)                    â”‚
â”‚   - åˆ é™¤ erase (éå°¾éƒ¨)                    â”‚
â”‚   - æŸ¥æ‰¾ find                               â”‚
â”‚   - resize                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä½¿ç”¨åœºæ™¯

### 1. éœ€è¦åŠ¨æ€å¤§å°çš„æ•°ç»„

```cpp
// è¯»å–ä¸ç¡®å®šæ•°é‡çš„è¾“å…¥
std::vector<int> numbers;
int n;
while (std::cin >> n) {
    numbers.push_back(n);
}
```

### 2. éœ€è¦é¢‘ç¹éšæœºè®¿é—®

```cpp
std::vector<int> v = {10, 20, 30, 40, 50};

// O(1) éšæœºè®¿é—®
for (int i = 0; i < v.size(); ++i) {
    std::cout << v[i] << " ";
}
```

### 3. éœ€è¦ä¸ C API äº¤äº’

```cpp
std::vector<int> v(100);

// ä¼ é€’ç»™ C å‡½æ•°
void c_function(int* data, int size);
c_function(v.data(), v.size());
```

### 4. éœ€è¦ç¼“å­˜å‹å¥½çš„å®¹å™¨

```cpp
// è¿ç»­å†…å­˜ï¼Œå……åˆ†åˆ©ç”¨ CPU ç¼“å­˜
std::vector<float> matrix(1000000);

// å¤§é‡è®¡ç®—æ—¶ï¼Œvector æ¯” list å¿«å¾—å¤š
for (size_t i = 0; i < matrix.size(); ++i) {
    matrix[i] *= 2.0f;
}
```

### 5. ä¸é€‚åˆä½¿ç”¨ vector çš„åœºæ™¯

```cpp
âŒ é¢‘ç¹åœ¨å¤´éƒ¨/ä¸­é—´æ’å…¥/åˆ é™¤
   â†’ ä½¿ç”¨ std::list æˆ– std::deque

âŒ éœ€è¦åœ¨è¿­ä»£å™¨éå†æ—¶æ’å…¥/åˆ é™¤
   â†’ ä½¿ç”¨ std::list

âŒ å…ƒç´ å¾ˆå¤§ä¸”éœ€è¦é¢‘ç¹ç§»åŠ¨
   â†’ ä½¿ç”¨å­˜å‚¨æŒ‡é’ˆçš„ vector
```

---

## æ€§èƒ½ä¼˜åŒ–

### 1. é¢„ç•™å®¹é‡ reserve()

```cpp
std::vector<int> v;

// âŒ ä½æ•ˆï¼šå¤šæ¬¡æ‰©å®¹
for (int i = 0; i < 10000; ++i) {
    v.push_back(i);  // å¯èƒ½è§¦å‘å¤šæ¬¡æ‰©å®¹
}

// âœ… é«˜æ•ˆï¼šä¸€æ¬¡æ€§é¢„ç•™
v.reserve(10000);
for (int i = 0; i < 10000; ++i) {
    v.push_back(i);  // ä¸ä¼šæ‰©å®¹
}
```

### 2. ä½¿ç”¨ emplace_back ä»£æ›¿ push_back

```cpp
struct Widget {
    Widget(int a, int b, int c) {}
};

std::vector<Widget> v;

// âŒ å…ˆæ„é€ ä¸´æ—¶å¯¹è±¡ï¼Œå†ç§»åŠ¨
v.push_back(Widget(1, 2, 3));

// âœ… ç›´æ¥åœ¨ vector ä¸­æ„é€ 
v.emplace_back(1, 2, 3);
```

### 3. é¿å…ä¸å¿…è¦çš„æ‹·è´

```cpp
// âŒ è¿”å› vector çš„æ‹·è´
std::vector<int> getVector() {
    std::vector<int> v = {1, 2, 3};
    return v;  // C++11 å‰ä¼šæ‹·è´
}

// âœ… ä½¿ç”¨ç§»åŠ¨è¯­ä¹‰ (C++11)
std::vector<int> getVector() {
    return {1, 2, 3};  // RVO (Return Value Optimization)
}

// âœ… ä½¿ç”¨å¼•ç”¨é¿å…æ‹·è´
void process(const std::vector<int>& v) {
    // ä¸ä¿®æ”¹ v æ—¶ä½¿ç”¨ const å¼•ç”¨
}
```

### 4. ä½¿ç”¨ bool vector çš„æ›¿ä»£æ–¹æ¡ˆ

```cpp
// âŒ std::vector<bool> æ˜¯ç‰¹åŒ–ç‰ˆæœ¬ï¼Œä¸æ˜¯çœŸæ­£çš„å®¹å™¨
std::vector<bool> v(100);
bool& x = v[0];  // âŒ ç¼–è¯‘é”™è¯¯ï¼Œè¿”å›ä»£ç†å¯¹è±¡

// âœ… ä½¿ç”¨ std::vector<char> æˆ– std::bitset
std::vector<char> v(100);
bool& x = v[0];  // âœ… æ­£å¸¸å¼•ç”¨
```

### 5. shrink_to_fit é‡Šæ”¾å†…å­˜

```cpp
std::vector<int> v = {1, 2, 3, 4, 5};
v.reserve(1000);  // capacity = 1000

// åˆ é™¤å¤§é‡å…ƒç´ å
v.clear();

// é‡Šæ”¾æœªä½¿ç”¨å†…å­˜
v.shrink_to_fit();  // capacity å¯èƒ½å‡å°‘åˆ° 0
```

---

## æ³¨æ„äº‹é¡¹

### 1. è¿­ä»£å™¨å¤±æ•ˆ

åœ¨æ’å…¥æˆ–åˆ é™¤å…ƒç´ åï¼Œè¿­ä»£å™¨å¯èƒ½å¤±æ•ˆï¼š

```cpp
std::vector<int> v = {1, 2, 3, 4, 5};
auto it = v.begin() + 2;  // æŒ‡å‘ 3

v.insert(v.begin(), 99);  // âŒ it å¯èƒ½å¤±æ•ˆ

// âœ… é‡æ–°è·å–è¿­ä»£å™¨
it = v.begin() + 3;  // éœ€è¦è°ƒæ•´ä½ç½®
```

**è¿­ä»£å™¨å¤±æ•ˆè§„åˆ™**ï¼š
- `push_back/pop_back`ï¼šä»…åœ¨æ‰©å®¹æ—¶å¤±æ•ˆ
- `insert/erase`ï¼šæ’å…¥/åˆ é™¤ç‚¹åŠå…¶åçš„è¿­ä»£å™¨å¤±æ•ˆ
- `resize`ï¼šå¯èƒ½å¤±æ•ˆ

### 2. è¾¹ç•Œæ£€æŸ¥

```cpp
std::vector<int> v = {1, 2, 3};

// âŒ ä¸å®‰å…¨ï¼Œè¶Šç•Œæ˜¯æœªå®šä¹‰è¡Œä¸º
int x = v[5];  // UB

// âœ… å®‰å…¨ï¼ŒæŠ›å‡ºå¼‚å¸¸
try {
    int y = v.at(5);  // std::out_of_range
} catch (const std::out_of_range& e) {
    std::cerr << e.what() << std::endl;
}
```

### 3. å†…å­˜é‡åˆ†é…

```cpp
std::vector<int> v = {1, 2, 3};
int* ptr = v.data();

v.push_back(4);  // å¯èƒ½æ‰©å®¹
// âŒ ptr ç°åœ¨å¯èƒ½å¤±æ•ˆ

// âœ… é‡æ–°è·å–æŒ‡é’ˆ
ptr = v.data();
```

### 4. bool vector çš„é™·é˜±

```cpp
std::vector<bool> vb = {true, false, true};
auto x = vb[0];  // x ä¸æ˜¯ bool&ï¼Œæ˜¯ä»£ç†å¯¹è±¡
x = true;        // âŒ ç¼–è¯‘é”™è¯¯

// âœ… ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆ
std::vector<char> vc = {1, 0, 1};
char& y = vc[0];  // âœ… æ­£å¸¸å¼•ç”¨
```

---

## å¸¸è§é—®é¢˜

### Q1: vector å’Œ array çš„åŒºåˆ«ï¼Ÿ

| ç‰¹æ€§ | std::vector | std::array (C++11) |
|------|-------------|-------------------|
| å¤§å° | åŠ¨æ€ | å›ºå®š |
| å†…å­˜ | å †ä¸Š | æ ˆä¸Š |
| æ€§èƒ½ | ç¨æ…¢ï¼ˆåŠ¨æ€åˆ†é…ï¼‰ | æ›´å¿«ï¼ˆé™æ€åˆ†é…ï¼‰ |
| ä½¿ç”¨åœºæ™¯ | å¤§å°æœªçŸ¥ | å¤§å°å·²çŸ¥ |

### Q2: vector å’Œ list çš„åŒºåˆ«ï¼Ÿ

| ç‰¹æ€§ | std::vector | std::list |
|------|-------------|-----------|
| å†…å­˜ç»“æ„ | è¿ç»­ | éè¿ç»­ï¼ˆèŠ‚ç‚¹ï¼‰ |
| éšæœºè®¿é—® | **O(1)** | O(n) |
| å¤´éƒ¨æ’å…¥ | O(n) | **O(1)** |
| ç¼“å­˜å‹å¥½ | âœ… | âŒ |

### Q3: å¦‚ä½•é«˜æ•ˆåˆ é™¤å…ƒç´ ï¼Ÿ

```cpp
// âŒ ä½æ•ˆï¼šé€ä¸ªåˆ é™¤ï¼ŒO(nÂ²)
std::vector<int> v = {1, 2, 3, 4, 5};
for (auto it = v.begin(); it != v.end(); ) {
    if (*it % 2 == 0) {
        it = v.erase(it);  // è¿”å›ä¸‹ä¸€ä¸ªæœ‰æ•ˆè¿­ä»£å™¨
    } else {
        ++it;
    }
}

// âœ… é«˜æ•ˆï¼šerase-remove æƒ¯ç”¨æ³•ï¼ŒO(n)
v.erase(std::remove(v.begin(), v.end(), 3),
        v.end());
```

### Q4: reserve å’Œ resize çš„åŒºåˆ«ï¼Ÿ

```cpp
std::vector<int> v;

// reserve - æ”¹å˜ capacityï¼Œä¸æ”¹å˜ size
v.reserve(100);  // capacity >= 100, size = 0
// v[0] = 1;     // âŒ è¶Šç•Œ

// resize - æ”¹å˜ sizeï¼Œå¯èƒ½æ”¹å˜ capacity
v.resize(100);   // size = 100, capacity >= 100
v[0] = 1;        // âœ… å®‰å…¨
```

### Q5: vector çš„æ‰©å®¹å€æ•°æ˜¯å¤šå°‘ï¼Ÿ

æ ‡å‡†æœªè§„å®šï¼Œå¸¸è§å®ç°ï¼š
- **GCC/Clang**: 2 å€
- **MSVC**: 1.5 å€

```cpp
// æŸ¥çœ‹æ‰©å®¹è¡Œä¸º
std::vector<int> v;
size_t old_cap = 0;
for (int i = 0; i < 100; ++i) {
    v.push_back(i);
    if (v.capacity() != old_cap) {
        std::cout << "Capacity changed: "
                  << old_cap << " -> "
                  << v.capacity() << std::endl;
        old_cap = v.capacity();
    }
}
```

---

## æ€»ç»“

### ä½•æ—¶ä½¿ç”¨ std::vector

âœ… **é€‚åˆ**ï¼š
- éœ€è¦åŠ¨æ€å¤§å°çš„æ•°ç»„
- é¢‘ç¹éšæœºè®¿é—®
- ä¸»è¦åœ¨å°¾éƒ¨æ“ä½œ
- éœ€è¦ç¼“å­˜å‹å¥½çš„å®¹å™¨
- ä¸ C API äº¤äº’

âŒ **ä¸é€‚åˆ**ï¼š
- é¢‘ç¹åœ¨å¤´éƒ¨/ä¸­é—´æ’å…¥åˆ é™¤
- éœ€è¦ç¨³å®šçš„è¿­ä»£å™¨
- å…ƒç´ å¾ˆå¤§ä¸”é¢‘ç¹ç§»åŠ¨

### æœ€ä½³å®è·µ

1. **ä½¿ç”¨ reserve()** é¢„ç•™å®¹é‡ï¼Œé¿å…å¤šæ¬¡æ‰©å®¹
2. **ä¼˜å…ˆä½¿ç”¨ emplace_back()** è€Œé push_back()
3. **ä½¿ç”¨ at()** è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ï¼Œæˆ–ç¡®ä¿ç´¢å¼•æ­£ç¡®
4. **ä¼ é€’å¼•ç”¨** `const vector<T>&` é¿å…æ‹·è´
5. **ç†è§£è¿­ä»£å™¨å¤±æ•ˆ** è§„åˆ™ï¼ŒåŠæ—¶æ›´æ–°è¿­ä»£å™¨
6. **ä½¿ç”¨ shrink_to_fit()** é‡Šæ”¾æœªä½¿ç”¨å†…å­˜

---

## å‚è€ƒèµ„æ–™

- [C++ Reference - std::vector](https://en.cppreference.com/w/cpp/container/vector)
- [C++ Standard Library - Sequence Containers](https://en.cppreference.com/w/cpp/container)
- [Effective STL - Scott Meyers](https://www.aristeia.com/books.html)
